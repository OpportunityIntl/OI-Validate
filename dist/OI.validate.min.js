/* OI-Validate v0.9.0 
 * Copyright (c) 2015 Opportunity International 
 */
!function(a){a.fn.validate=function(b){return this.each(function(){new Validate(a(this),b)})}}(jQuery);var Validate=function(a,b){function c(a){var b=$(a).data("oi-validate");return b?b:!1}function d(a,b){var d=c($(a))||{};data=$.extend(d,b),$(a).data("oi-validate",data)}function e(a){var b={validations:[],element:a,errorMessages:[]};a.is("[required]")&&b.validations.push({validation:function(){return""!==$(this).val()},fieldMessage:"Required field",formMessage:"Please fill out missing fields"}),a.is('[type="email"]')&&b.validations.push({validation:function(){var a=/^[0-9a-zA-Z][-.+_a-zA-Z0-9]*@([0-9a-zA-Z][-._0-9a-zA-Z]*\.)+[a-zA-Z]{2,6}$/;return a.test($(this).val())},fieldMessage:"Invalid email address",formMessage:"Please enter valid email address"}),a.is("select")&&(b.element=a.parents(".select")),d($(a),b)}function f(a,b){var e=c(a)||{};e.validations.push(b),d(a,e)}function g(){k.form.find('input[type!="radio"][required], select[required], textarea[required]').each(function(){k.addField($(this))}),$.each(k.options.fieldValidations,function(a,b){console.log(k.form.find(b.field)),f(k.form.find(b.field),b)})}function h(a,b){var c=$(this).find(".alert");c.length>0&&c.remove(),c=$("<div>",{"class":"alert "+(b?b:"error"),style:"display: none"}),$(this).prepend(c),c.html(a),c.slideDown(500)}function i(){var a=$(this).find(".alert");a.slideUp(500,function(){a.remove()})}function j(){k.form.attr("novalidate","novalidate"),k.hideErrors(),k.form.submit(function(){return k.hideErrors(),k.validateOnBlur(!1),k.validate()?"function"==typeof k.options.onSuccess&&k.options.onSuccess.call(k)===!1?!1:void 0:(k.displayErrors(),k.validateOnBlur(!0),"function"==typeof k.options.onError&&k.options.onError.call(k),!1)}),g(),k.options.onInit.call(k)}var k=this;this.options=$.extend({onInit:function(){},onError:function(){},onSuccess:function(){},formValidations:[],fieldValidations:[],showAlert:h,hideAlert:i},b),this.form=$(a),this.fields=$(),this.errorMessages=[],this.validate=function(){var a=0;return k.fields.each(function(){k.validateField($(this))||a++}),$.each(k.options.formValidations,function(b,c){c.validation.call(k.form)||(c.formMessage&&k.errorMessages.push(c.formMessage),a++)}),a>0?!1:!0},this.validateField=function(a){var b=c(a),e=!0;return b&&$.each(b.validations,function(c,f){if(f.validation.call(a)){var g=b.errorMessages.indexOf(f.fieldMessage);-1!==g&&(b.errorMessages.splice(b.errorMessages.indexOf(f.fieldMessage),1),d(a,b),k.hideError(a,f.fieldMessage)),e=!0}else f.fieldMessage&&-1===b.errorMessages.indexOf(f.fieldMessage)&&(b.errorMessages.push(f.fieldMessage),d(a,b),k.displayError(a,f.fieldMessage)),f.formMessage&&k.errorMessages.push(f.formMessage),e=!1}),e},this.displayError=function(a,b){var d=c(a),e=$("<div>",{"class":"error-message",style:"display: none"});e.html(b),d.element.after(e),e.slideDown(500),d.element.addClass("error")},this.hideError=function(a,b){var d=c($(a)),e=(d.errorMessages.indexOf(b),d.element.siblings('.error-message:contains("'+b+'")'));e.slideUp(500,function(){e.remove()}),d.element.removeClass("error")},this.displayErrors=function(){var a=k.errorMessages.reduce(function(a,b){return a.indexOf(b)<0&&a.push(b),a},[]),b="<p><strong>Looks like there are some problems with the highlighted fields. Please address the following errors:</strong></p>";b+="<ul>",$.each(a,function(a,c){b+="<li>"+c+"</li>"}),b+="</ul>",k.alert(b)},this.alert=function(a,b){k.options.showAlert.call(k.form,a,b)},this.hideAlert=function(){k.options.hideAlert.call(k.form)},this.hideErrors=function(){k.hideAlert(),k.errorMessages=[],k.fields.each(function(a,b){var e=c(b);$.each(e.errorMessages,function(a,c){k.hideError(b,c),e.errorMessages.splice(a,1),d(b,e)})})},this.validateOnBlur=function(a){a?k.fields.on("blur.validate change.validate",function(){k.validateField($(this))}):k.fields.off("blur.validate change.validate")},this.addField=function(a){e(a),k.fields=k.fields.add(a)},j()};